<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hub de Juegos Web - 3 Juegos en 1</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 40px 0;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .game-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .game-title {
            font-size: 1.8rem;
            margin-bottom: 15px;
            text-align: center;
            color: #ffd700;
        }

        .game-canvas {
            width: 100%;
            max-width: 400px;
            height: 300px;
            border: 3px solid #ffd700;
            border-radius: 10px;
            margin: 0 auto 15px;
            display: block;
            background: #000;
        }

        .game-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn:hover {
            background: linear-gradient(45deg, #ee5a24, #ff6b6b);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .game-info {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .score {
            font-size: 1.1rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
        }

        .instructions {
            font-size: 0.9rem;
            opacity: 0.8;
            line-height: 1.4;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }

        .volume-slider {
            width: 100px;
        }

        #game3Canvas {
            cursor: crosshair;
        }

        .footer {
            text-align: center;
            padding: 30px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            margin-top: 30px;
        }

        .tech-stack {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .tech-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .game-controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéÆ Hub de Juegos Web üéÆ</h1>
            <p>Tres juegos √∫nicos en una sola p√°gina - Simple, Con Sonido y Elaborado</p>
        </div>

        <div class="games-grid">
            <!-- JUEGO 1: Snake Simple -->
            <div class="game-card">
                <h2 class="game-title">üêç Snake Cl√°sico (Simple)</h2>
                <canvas id="game1Canvas" class="game-canvas" width="400" height="300"></canvas>
                <div class="game-controls">
                    <button id="game1Start" class="btn">Iniciar Juego</button>
                    <button id="game1Reset" class="btn">Reiniciar</button>
                </div>
                <div class="game-info">
                    <div id="game1Score" class="score">Puntuaci√≥n: 0</div>
                    <div class="instructions">
                        <strong>Instrucciones:</strong><br>
                        ‚Ä¢ Usa WASD o flechas para mover la serpiente<br>
                        ‚Ä¢ Come las manzanas rojas para crecer<br>
                        ‚Ä¢ Evita chocar con paredes y contigo mismo<br>
                        ‚Ä¢ Juego simple sin sonido
                    </div>
                </div>
            </div>

            <!-- JUEGO 2: Breakout con Sonido -->
            <div class="game-card">
                <h2 class="game-title">üéµ Breakout Musical (Con Sonido)</h2>
                <canvas id="game2Canvas" class="game-canvas" width="400" height="300"></canvas>
                <div class="game-controls">
                    <button id="game2Start" class="btn">Iniciar Juego</button>
                    <button id="game2Reset" class="btn">Reiniciar</button>
                </div>
                <div class="audio-controls">
                    <span>üîä Volumen:</span>
                    <input type="range" id="game2Volume" class="volume-slider" min="0" max="100" value="50">
                    <button id="game2Mute" class="btn" style="padding: 8px 12px;">üîá</button>
                </div>
                <div class="game-info">
                    <div id="game2Score" class="score">Puntuaci√≥n: 0 | Vidas: 3</div>
                    <div class="instructions">
                        <strong>Instrucciones:</strong><br>
                        ‚Ä¢ Mueve la paleta con A/D o flechas<br>
                        ‚Ä¢ Rebota la pelota para romper bloques<br>
                        ‚Ä¢ Efectos de sonido al golpear bloques<br>
                        ‚Ä¢ M√∫sica de fondo opcional
                    </div>
                </div>
            </div>

            <!-- JUEGO 3: Space Shooter Avanzado -->
            <div class="game-card">
                <h2 class="game-title">üöÄ Space Defense Elite (Elaborado)</h2>
                <canvas id="game3Canvas" class="game-canvas" width="400" height="300"></canvas>
                <div class="game-controls">
                    <button id="game3Start" class="btn">Iniciar Misi√≥n</button>
                    <button id="game3Pause" class="btn">Pausar</button>
                    <button id="game3Reset" class="btn">Reiniciar</button>
                </div>
                <div class="audio-controls">
                    <span>üîä Audio:</span>
                    <input type="range" id="game3Volume" class="volume-slider" min="0" max="100" value="70">
                    <button id="game3Mute" class="btn" style="padding: 8px 12px;">üîá</button>
                </div>
                <div class="game-info">
                    <div id="game3Score" class="score">Puntuaci√≥n: 0 | Vidas: 5 | Nivel: 1</div>
                    <div class="instructions">
                        <strong>Instrucciones:</strong><br>
                        ‚Ä¢ Mueve con WASD o flechas<br>
                        ‚Ä¢ Dispara con ESPACIO o clic<br>
                        ‚Ä¢ Recoge power-ups especiales<br>
                        ‚Ä¢ M√∫ltiples tipos de enemigos y jefes<br>
                        ‚Ä¢ Sistema de sonido completo
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <h3>üìã Informaci√≥n del Proyecto</h3>
            <p>Proyecto de desarrollo web con HTML5 Canvas, JavaScript y Web Audio API</p>
            <div class="tech-stack">
                <div class="tech-item">HTML5 Canvas</div>
                <div class="tech-item">JavaScript ES6+</div>
                <div class="tech-item">Web Audio API</div>
                <div class="tech-item">CSS3 Animations</div>
                <div class="tech-item">Responsive Design</div>
            </div>
        </div>
    </div>

    <script>
        // AUDIO CONTEXT SETUP
        let audioContext;
        let isMuted = false;

        function initAudioContext() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
        }

        function playTone(frequency, duration, volume = 0.1) {
            if (!audioContext || isMuted) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }

        // GAME 1: SNAKE (SIMPLE)
        class SnakeGame {
            constructor() {
                this.canvas = document.getElementById('game1Canvas');
                this.ctx = this.canvas.getContext('2d');
                this.startBtn = document.getElementById('game1Start');
                this.resetBtn = document.getElementById('game1Reset');
                this.scoreElement = document.getElementById('game1Score');
                
                this.gridSize = 20;
                this.tileCount = this.canvas.width / this.gridSize;
                
                this.reset();
                this.bindEvents();
                this.draw();
            }
            
            reset() {
                this.snake = [{x: 10, y: 10}];
                this.dx = 0;
                this.dy = 0;
                this.score = 0;
                this.running = false;
                this.gameLoopId = null;
                
                // Colocar la primera comida
                this.placeFood();
                
                this.updateScore();
                this.draw();
            }
            
            bindEvents() {
                this.startBtn.addEventListener('click', () => this.start());
                this.resetBtn.addEventListener('click', () => {
                    if (this.gameLoopId) {
                        clearTimeout(this.gameLoopId);
                        this.gameLoopId = null;
                    }
                    this.reset();
                });
                
                document.addEventListener('keydown', (e) => {
                    if (!this.running) return;
                    
                    switch(e.code) {
                        case 'ArrowUp':
                        case 'KeyW':
                            if (this.dy === 0) { this.dx = 0; this.dy = -1; }
                            break;
                        case 'ArrowDown':
                        case 'KeyS':
                            if (this.dy === 0) { this.dx = 0; this.dy = 1; }
                            break;
                        case 'ArrowLeft':
                        case 'KeyA':
                            if (this.dx === 0) { this.dx = -1; this.dy = 0; }
                            break;
                        case 'ArrowRight':
                        case 'KeyD':
                            if (this.dx === 0) { this.dx = 1; this.dy = 0; }
                            break;
                    }
                    e.preventDefault();
                });
            }
            
            start() {
                if (this.running) return;
                
                // Resetear si es necesario
                if (this.dx === 0 && this.dy === 0) {
                    this.dx = 1; // Empezar movi√©ndose a la derecha
                }
                
                this.running = true;
                this.startBtn.textContent = 'Jugando...';
                this.startBtn.disabled = true;
                this.gameLoop();
            }
            
            gameLoop() {
                if (!this.running) return;
                
                this.update();
                this.draw();
                
                this.gameLoopId = setTimeout(() => this.gameLoop(), 150);
            }
            
            update() {
                // Si no hay movimiento, no actualizar
                if (this.dx === 0 && this.dy === 0) return;
                
                const head = {x: this.snake[0].x + this.dx, y: this.snake[0].y + this.dy};
                
                // Verificar colisiones con paredes
                if (head.x < 0 || head.x >= this.tileCount || 
                    head.y < 0 || head.y >= Math.floor(this.canvas.height / this.gridSize)) {
                    this.gameOver();
                    return;
                }
                
                // Verificar colisiones con el cuerpo
                for (let segment of this.snake) {
                    if (head.x === segment.x && head.y === segment.y) {
                        this.gameOver();
                        return;
                    }
                }
                
                this.snake.unshift(head);
                
                // Verificar si come la comida
                if (head.x === this.food.x && head.y === this.food.y) {
                    this.score += 10;
                    this.updateScore();
                    this.placeFood();
                } else {
                    this.snake.pop();
                }
            }
            
            placeFood() {
                const maxTilesX = Math.floor(this.canvas.width / this.gridSize);
                const maxTilesY = Math.floor(this.canvas.height / this.gridSize);
                
                let newFood;
                let validPosition = false;
                let attempts = 0;
                
                // Asegurar que la comida no aparezca en la serpiente
                while (!validPosition && attempts < 100) {
                    newFood = {
                        x: Math.floor(Math.random() * maxTilesX),
                        y: Math.floor(Math.random() * maxTilesY)
                    };
                    
                    validPosition = true;
                    for (let segment of this.snake) {
                        if (segment.x === newFood.x && segment.y === newFood.y) {
                            validPosition = false;
                            break;
                        }
                    }
                    attempts++;
                }
                
                // Si no encuentra posici√≥n v√°lida, poner en una esquina libre
                if (!validPosition) {
                    newFood = {
                        x: maxTilesX - 1,
                        y: maxTilesY - 1
                    };
                }
                
                this.food = newFood;
                console.log(`Comida colocada en: x=${this.food.x}, y=${this.food.y}`);
            }
            
            draw() {
                // Fondo
                this.ctx.fillStyle = 'black';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Serpiente
                for (let i = 0; i < this.snake.length; i++) {
                    const segment = this.snake[i];
                    if (i === 0) {
                        // Cabeza m√°s brillante
                        this.ctx.fillStyle = '#00ff00';
                    } else {
                        // Cuerpo
                        this.ctx.fillStyle = '#00cc00';
                    }
                    this.ctx.fillRect(
                        segment.x * this.gridSize, 
                        segment.y * this.gridSize, 
                        this.gridSize - 2, 
                        this.gridSize - 2
                    );
                }
                
                // Comida - asegurar que existe antes de dibujar
                if (this.food && typeof this.food.x !== 'undefined' && typeof this.food.y !== 'undefined') {
                    // Fondo rojo de la manzana
                    this.ctx.fillStyle = 'red';
                    this.ctx.fillRect(
                        this.food.x * this.gridSize, 
                        this.food.y * this.gridSize, 
                        this.gridSize - 2, 
                        this.gridSize - 2
                    );
                    
                    // Brillo naranja en la manzana
                    this.ctx.fillStyle = 'orange';
                    this.ctx.fillRect(
                        this.food.x * this.gridSize + 2, 
                        this.food.y * this.gridSize + 2, 
                        4, 4
                    );
                    
                    // Debug: mostrar coordenadas de la comida en la consola
                    // console.log(`Dibujando comida en: x=${this.food.x}, y=${this.food.y}`);
                }
            }
            
            gameOver() {
                this.running = false;
                if (this.gameLoopId) {
                    clearTimeout(this.gameLoopId);
                    this.gameLoopId = null;
                }
                
                this.startBtn.textContent = 'Iniciar Juego';
                this.startBtn.disabled = false;
                
                // Overlay de game over
                this.ctx.fillStyle = 'rgba(255, 0, 0, 0.7)';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Texto de game over
                this.ctx.fillStyle = 'white';
                this.ctx.font = 'bold 24px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.fillText('GAME OVER', this.canvas.width/2, this.canvas.height/2 - 20);
                
                this.ctx.font = '18px Arial';
                this.ctx.fillText(`Puntuaci√≥n Final: ${this.score}`, this.canvas.width/2, this.canvas.height/2 + 10);
                
                this.ctx.font = '14px Arial';
                this.ctx.fillText('Presiona "Reiniciar" para jugar de nuevo', this.canvas.width/2, this.canvas.height/2 + 40);
            }
            
            updateScore() {
                this.scoreElement.textContent = `Puntuaci√≥n: ${this.score}`;
            }
        }

        // GAME 2: BREAKOUT WITH SOUND
        class BreakoutGame {
            constructor() {
                this.canvas = document.getElementById('game2Canvas');
                this.ctx = this.canvas.getContext('2d');
                this.startBtn = document.getElementById('game2Start');
                this.resetBtn = document.getElementById('game2Reset');
                this.muteBtn = document.getElementById('game2Mute');
                this.volumeSlider = document.getElementById('game2Volume');
                this.scoreElement = document.getElementById('game2Score');
                
                this.reset();
                this.bindEvents();
                this.draw();
            }
            
            reset() {
                this.paddle = {
                    x: this.canvas.width / 2 - 50,
                    y: this.canvas.height - 20,
                    width: 100,
                    height: 10,
                    speed: 8
                };
                
                this.ball = {
                    x: this.canvas.width / 2,
                    y: this.canvas.height - 40,
                    dx: 4,
                    dy: -4,
                    radius: 8
                };
                
                this.bricks = [];
                for (let r = 0; r < 4; r++) {
                    for (let c = 0; c < 8; c++) {
                        this.bricks.push({
                            x: c * 50 + 25,
                            y: r * 20 + 40,
                            width: 40,
                            height: 15,
                            color: `hsl(${r * 60}, 70%, 60%)`
                        });
                    }
                }
                
                this.score = 0;
                this.lives = 3;
                this.running = false;
                this.keys = {};
                this.updateScore();
            }
            
            bindEvents() {
                this.startBtn.addEventListener('click', () => this.start());
                this.resetBtn.addEventListener('click', () => this.reset());
                this.muteBtn.addEventListener('click', () => this.toggleMute());
                
                document.addEventListener('keydown', (e) => {
                    this.keys[e.code] = true;
                });
                
                document.addEventListener('keyup', (e) => {
                    this.keys[e.code] = false;
                });
            }
            
            start() {
                initAudioContext();
                if (this.running) return;
                this.running = true;
                this.startBtn.textContent = 'Jugando...';
                this.startBtn.disabled = true;
                this.gameLoop();
            }
            
            gameLoop() {
                if (!this.running) return;
                
                this.update();
                this.draw();
                
                requestAnimationFrame(() => this.gameLoop());
            }
            
            update() {
                // Paddle movement
                if (this.keys['KeyA'] || this.keys['ArrowLeft']) {
                    this.paddle.x = Math.max(0, this.paddle.x - this.paddle.speed);
                }
                if (this.keys['KeyD'] || this.keys['ArrowRight']) {
                    this.paddle.x = Math.min(this.canvas.width - this.paddle.width, 
                                           this.paddle.x + this.paddle.speed);
                }
                
                // Ball movement
                this.ball.x += this.ball.dx;
                this.ball.y += this.ball.dy;
                
                // Ball collision with walls
                if (this.ball.x - this.ball.radius < 0 || 
                    this.ball.x + this.ball.radius > this.canvas.width) {
                    this.ball.dx = -this.ball.dx;
                    this.playSound(400, 0.1);
                }
                
                if (this.ball.y - this.ball.radius < 0) {
                    this.ball.dy = -this.ball.dy;
                    this.playSound(400, 0.1);
                }
                
                // Ball collision with paddle
                if (this.ball.y + this.ball.radius > this.paddle.y &&
                    this.ball.x > this.paddle.x &&
                    this.ball.x < this.paddle.x + this.paddle.width &&
                    this.ball.dy > 0) {
                    this.ball.dy = -this.ball.dy;
                    this.playSound(300, 0.15);
                }
                
                // Ball collision with bricks
                for (let i = this.bricks.length - 1; i >= 0; i--) {
                    const brick = this.bricks[i];
                    if (this.ball.x + this.ball.radius > brick.x &&
                        this.ball.x - this.ball.radius < brick.x + brick.width &&
                        this.ball.y + this.ball.radius > brick.y &&
                        this.ball.y - this.ball.radius < brick.y + brick.height) {
                        this.ball.dy = -this.ball.dy;
                        this.bricks.splice(i, 1);
                        this.score += 10;
                        this.updateScore();
                        this.playSound(600, 0.2);
                    }
                }
                
                // Ball falls below paddle
                if (this.ball.y > this.canvas.height) {
                    this.lives--;
                    this.updateScore();
                    this.playSound(150, 0.5);
                    
                    if (this.lives <= 0) {
                        this.gameOver();
                    } else {
                        this.resetBall();
                    }
                }
                
                // Win condition
                if (this.bricks.length === 0) {
                    this.gameWon();
                }
            }
            
            resetBall() {
                this.ball.x = this.canvas.width / 2;
                this.ball.y = this.canvas.height - 40;
                this.ball.dx = (Math.random() > 0.5 ? 1 : -1) * 4;
                this.ball.dy = -4;
            }
            
            draw() {
                this.ctx.fillStyle = 'black';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Draw bricks
                for (let brick of this.bricks) {
                    this.ctx.fillStyle = brick.color;
                    this.ctx.fillRect(brick.x, brick.y, brick.width, brick.height);
                    this.ctx.strokeStyle = 'white';
                    this.ctx.strokeRect(brick.x, brick.y, brick.width, brick.height);
                }
                
                // Draw paddle
                this.ctx.fillStyle = 'white';
                this.ctx.fillRect(this.paddle.x, this.paddle.y, this.paddle.width, this.paddle.height);
                
                // Draw ball
                this.ctx.beginPath();
                this.ctx.arc(this.ball.x, this.ball.y, this.ball.radius, 0, Math.PI * 2);
                this.ctx.fillStyle = 'yellow';
                this.ctx.fill();
                this.ctx.closePath();
            }
            
            playSound(frequency, duration) {
                const volume = this.volumeSlider.value / 100 * 0.3;
                playTone(frequency, duration, volume);
            }
            
            toggleMute() {
                isMuted = !isMuted;
                this.muteBtn.textContent = isMuted ? 'üîä' : 'üîá';
            }
            
            gameOver() {
                this.running = false;
                this.startBtn.textContent = 'Iniciar Juego';
                this.startBtn.disabled = false;
                
                this.ctx.fillStyle = 'rgba(255, 0, 0, 0.7)';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                this.ctx.fillStyle = 'white';
                this.ctx.font = '24px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.fillText('GAME OVER', this.canvas.width/2, this.canvas.height/2);
            }
            
            gameWon() {
                this.running = false;
                this.startBtn.textContent = 'Iniciar Juego';
                this.startBtn.disabled = false;
                
                this.ctx.fillStyle = 'rgba(0, 255, 0, 0.7)';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                this.ctx.fillStyle = 'white';
                this.ctx.font = '24px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.fillText('¬°GANASTE!', this.canvas.width/2, this.canvas.height/2);
            }
            
            updateScore() {
                this.scoreElement.textContent = `Puntuaci√≥n: ${this.score} | Vidas: ${this.lives}`;
            }
        }

        // GAME 3: SPACE SHOOTER (ADVANCED)
        class SpaceShooterGame {
            constructor() {
                this.canvas = document.getElementById('game3Canvas');
                this.ctx = this.canvas.getContext('2d');
                this.startBtn = document.getElementById('game3Start');
                this.pauseBtn = document.getElementById('game3Pause');
                this.resetBtn = document.getElementById('game3Reset');
                this.muteBtn = document.getElementById('game3Mute');
                this.volumeSlider = document.getElementById('game3Volume');
                this.scoreElement = document.getElementById('game3Score');
                
                this.reset();
                this.bindEvents();
                this.draw();
            }
            
            reset() {
                this.player = {
                    x: this.canvas.width / 2,
                    y: this.canvas.height - 40,
                    width: 30,
                    height: 20,
                    speed: 6,
                    shootCooldown: 0
                };
                
                this.bullets = [];
                this.enemies = [];
                this.powerups = [];
                this.particles = [];
                
                this.score = 0;
                this.lives = 5;
                this.level = 1;
                this.running = false;
                this.paused = false;
                this.keys = {};
                this.enemySpawnTimer = 0;
                this.powerupSpawnTimer = 0;
                
                this.updateScore();
            }
            
            bindEvents() {
                this.startBtn.addEventListener('click', () => this.start());
                this.pauseBtn.addEventListener('click', () => this.togglePause());
                this.resetBtn.addEventListener('click', () => this.reset());
                this.muteBtn.addEventListener('click', () => this.toggleMute());
                
                this.canvas.addEventListener('click', (e) => this.handleClick(e));
                
                document.addEventListener('keydown', (e) => {
                    this.keys[e.code] = true;
                    if (e.code === 'Space') {
                        e.preventDefault();
                        this.shoot();
                    }
                });
                
                document.addEventListener('keyup', (e) => {
                    this.keys[e.code] = false;
                });
            }
            
            start() {
                initAudioContext();
                if (this.running && !this.paused) return;
                this.running = true;
                this.paused = false;
                this.startBtn.textContent = 'En Misi√≥n...';
                this.startBtn.disabled = true;
                this.pauseBtn.disabled = false;
                this.gameLoop();
            }
            
            togglePause() {
                if (!this.running) return;
                this.paused = !this.paused;
                this.pauseBtn.textContent = this.paused ? 'Reanudar' : 'Pausar';
                if (!this.paused) this.gameLoop();
            }
            
            handleClick(e) {
                if (this.running && !this.paused) {
                    this.shoot();
                }
            }
            
            gameLoop() {
                if (!this.running || this.paused) return;
                
                this.update();
                this.draw();
                
                requestAnimationFrame(() => this.gameLoop());
            }
            
            update() {
                // Player movement
                if (this.keys['KeyA'] || this.keys['ArrowLeft']) {
                    this.player.x = Math.max(0, this.player.x - this.player.speed);
                }
                if (this.keys['KeyD'] || this.keys['ArrowRight']) {
                    this.player.x = Math.min(this.canvas.width - this.player.width, 
                                           this.player.x + this.player.speed);
                }
                if (this.keys['KeyW'] || this.keys['ArrowUp']) {
                    this.player.y = Math.max(0, this.player.y - this.player.speed);
                }
                if (this.keys['KeyS'] || this.keys['ArrowDown']) {
                    this.player.y = Math.min(this.canvas.height - this.player.height, 
                                           this.player.y + this.player.speed);
                }
                
                if (this.player.shootCooldown > 0) this.player.shootCooldown--;
                
                // Update bullets
                for (let i = this.bullets.length - 1; i >= 0; i--) {
                    const bullet = this.bullets[i];
                    bullet.y -= bullet.speed;
                    
                    if (bullet.y < 0) {
                        this.bullets.splice(i, 1);
                    }
                }
                
                // Spawn enemies
                this.enemySpawnTimer++;
                if (this.enemySpawnTimer > 60 - this.level * 5) {
                    this.spawnEnemy();
                    this.enemySpawnTimer = 0;
                }
                
                // Update enemies
                for (let i = this.enemies.length - 1; i >= 0; i--) {
                    const enemy = this.enemies[i];
                    enemy.y += enemy.speed;
                    enemy.x += Math.sin(enemy.y * 0.01) * enemy.wobble;
                    
                    if (enemy.y > this.canvas.height) {
                        this.enemies.splice(i, 1);
                        this.lives--;
                        this.updateScore();
                        this.playSound(200, 0.3);
                        
                        if (this.lives <= 0) {
                            this.gameOver();
                            return;
                        }
                    }
                }
                
                // Spawn powerups
                this.powerupSpawnTimer++;
                if (this.powerupSpawnTimer > 600) {
                    this.spawnPowerup();
                    this.powerupSpawnTimer = 0;
                }
                
                // Update powerups
                for (let i = this.powerups.length - 1; i >= 0; i--) {
                    const powerup = this.powerups[i];
                    powerup.y += powerup.speed;
                    powerup.rotation += 0.1;
                    
                    if (powerup.y > this.canvas.height) {
                        this.powerups.splice(i, 1);
                    }
                }
                
                // Collision detection: bullets vs enemies
                for (let i = this.bullets.length - 1; i >= 0; i--) {
                    const bullet = this.bullets[i];
                    for (let j = this.enemies.length - 1; j >= 0; j--) {
                        const enemy = this.enemies[j];
                        
                        if (this.checkCollision(bullet, enemy)) {
                            this.bullets.splice(i, 1);
                            this.enemies.splice(j, 1);
                            this.score += enemy.points;
                            this.updateScore();
                            this.createExplosion(enemy.x, enemy.y);
                            this.playSound(800, 0.15);
                            break;
                        }
                    }
                }
                
                // Collision detection: player vs enemies
                for (let i = this.enemies.length - 1; i >= 0; i--) {
                    const enemy = this.enemies[i];
                    if (this.checkCollision(this.player, enemy)) {
                        this.enemies.splice(i, 1);
                        this.lives--;
                        this.updateScore();
                        this.createExplosion(this.player.x, this.player.y);
                        this.playSound(150, 0.5);
                        
                        if (this.lives <= 0) {
                            this.gameOver();
                            return;
                        }
                    }
                }
                
                // Collision detection: player vs powerups
                for (let i = this.powerups.length - 1; i >= 0; i--) {
                    const powerup = this.powerups[i];
                    if (this.checkCollision(this.player, powerup)) {
                        this.powerups.splice(i, 1);
                        this.applyPowerup(powerup.type);
                        this.playSound(1000, 0.2);
                    }
                }
                
                // Update particles
                for (let i = this.particles.length - 1; i >= 0; i--) {
                    const particle = this.particles[i];
                    particle.x += particle.vx;
                    particle.y += particle.vy;
                    particle.life--;
                    
                    if (particle.life <= 0) {
                        this.particles.splice(i, 1);
                    }
                }
                
                // Level progression
                if (this.score > this.level * 500) {
                    this.level++;
                    this.updateScore();
                    this.playSound(1200, 0.3);
                }
            }
            
            spawnEnemy() {
                const types = [
                    { width: 20, height: 15, speed: 2, points: 10, color: '#ff4444', wobble: 1 },
                    { width: 25, height: 20, speed: 1.5, points: 20, color: '#4444ff', wobble: 2 },
                    { width: 30, height: 25, speed: 1, points: 30, color: '#44ff44', wobble: 0.5 }
                ];
                
                const type = types[Math.floor(Math.random() * types.length)];
                const enemy = {
                    x: Math.random() * (this.canvas.width - type.width),
                    y: -type.height,
                    ...type
                };
                
                this.enemies.push(enemy);
            }
            
            spawnPowerup() {
                const types = ['health', 'speed', 'multishot'];
                const type = types[Math.floor(Math.random() * types.length)];
                
                const powerup = {
                    x: Math.random() * (this.canvas.width - 20),
                    y: -20,
                    width: 20,
                    height: 20,
                    speed: 2,
                    type: type,
                    rotation: 0
                };
                
                this.powerups.push(powerup);
            }
            
            shoot() {
                if (this.player.shootCooldown > 0 || !this.running || this.paused) return;
                
                const bullet = {
                    x: this.player.x + this.player.width / 2 - 2,
                    y: this.player.y,
                    width: 4,
                    height: 10,
                    speed: 8
                };
                
                this.bullets.push(bullet);
                this.player.shootCooldown = 10;
                this.playSound(600, 0.1);
            }
            
            checkCollision(obj1, obj2) {
                return obj1.x < obj2.x + obj2.width &&
                       obj1.x + obj1.width > obj2.x &&
                       obj1.y < obj2.y + obj2.height &&
                       obj1.y + obj1.height > obj2.y;
            }
            
            createExplosion(x, y) {
                for (let i = 0; i < 8; i++) {
                    this.particles.push({
                        x: x,
                        y: y,
                        vx: (Math.random() - 0.5) * 6,
                        vy: (Math.random() - 0.5) * 6,
                        life: 20,
                        color: `hsl(${Math.random() * 60 + 10}, 100%, 50%)`
                    });
                }
            }
            
            applyPowerup(type) {
                switch(type) {
                    case 'health':
                        this.lives = Math.min(this.lives + 1, 10);
                        break;
                    case 'speed':
                        this.player.speed = Math.min(this.player.speed + 1, 12);
                        break;
                    case 'multishot':
                        // Implement multishot temporarily
                        break;
                }
                this.updateScore();
            }
            
            draw() {
                // Background
                this.ctx.fillStyle = 'black';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Stars background effect
                this.ctx.fillStyle = 'white';
                for (let i = 0; i < 50; i++) {
                    const x = (i * 123456) % this.canvas.width;
                    const y = (i * 654321 + Date.now() * 0.1) % this.canvas.height;
                    this.ctx.fillRect(x, y, 1, 1);
                }
                
                // Draw player
                this.ctx.fillStyle = '#00ff00';
                this.ctx.fillRect(this.player.x, this.player.y, this.player.width, this.player.height);
                
                // Draw player cockpit
                this.ctx.fillStyle = '#ffffff';
                this.ctx.fillRect(this.player.x + this.player.width/2 - 2, this.player.y + 2, 4, 6);
                
                // Draw bullets
                this.ctx.fillStyle = '#ffff00';
                for (let bullet of this.bullets) {
                    this.ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
                }
                
                // Draw enemies
                for (let enemy of this.enemies) {
                    this.ctx.fillStyle = enemy.color;
                    this.ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
                    
                    // Enemy details
                    this.ctx.fillStyle = '#ffffff';
                    this.ctx.fillRect(enemy.x + 2, enemy.y + 2, enemy.width - 4, 2);
                }
                
                // Draw powerups
                for (let powerup of this.powerups) {
                    this.ctx.save();
                    this.ctx.translate(powerup.x + powerup.width/2, powerup.y + powerup.height/2);
                    this.ctx.rotate(powerup.rotation);
                    
                    switch(powerup.type) {
                        case 'health':
                            this.ctx.fillStyle = '#ff0000';
                            break;
                        case 'speed':
                            this.ctx.fillStyle = '#0000ff';
                            break;
                        case 'multishot':
                            this.ctx.fillStyle = '#ffff00';
                            break;
                    }
                    
                    this.ctx.fillRect(-powerup.width/2, -powerup.height/2, powerup.width, powerup.height);
                    this.ctx.restore();
                }
                
                // Draw particles
                for (let particle of this.particles) {
                    this.ctx.fillStyle = particle.color;
                    this.ctx.globalAlpha = particle.life / 20;
                    this.ctx.fillRect(particle.x, particle.y, 3, 3);
                    this.ctx.globalAlpha = 1;
                }
                
                // Pause overlay
                if (this.paused) {
                    this.ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                    this.ctx.fillStyle = 'white';
                    this.ctx.font = '24px Arial';
                    this.ctx.textAlign = 'center';
                    this.ctx.fillText('PAUSADO', this.canvas.width/2, this.canvas.height/2);
                }
            }
            
            playSound(frequency, duration) {
                const volume = this.volumeSlider.value / 100 * 0.2;
                playTone(frequency, duration, volume);
            }
            
            toggleMute() {
                isMuted = !isMuted;
                this.muteBtn.textContent = isMuted ? 'üîä' : 'üîá';
            }
            
            gameOver() {
                this.running = false;
                this.startBtn.textContent = 'Iniciar Misi√≥n';
                this.startBtn.disabled = false;
                this.pauseBtn.disabled = true;
                
                this.ctx.fillStyle = 'rgba(255, 0, 0, 0.8)';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                this.ctx.fillStyle = 'white';
                this.ctx.font = '20px Arial';
                this.ctx.textAlign = 'center';
                this.ctx.fillText('MISI√ìN FALLIDA', this.canvas.width/2, this.canvas.height/2 - 20);
                this.ctx.fillText(`Puntuaci√≥n Final: ${this.score}`, this.canvas.width/2, this.canvas.height/2 + 10);
                this.ctx.fillText(`Nivel Alcanzado: ${this.level}`, this.canvas.width/2, this.canvas.height/2 + 40);
            }
            
            updateScore() {
                this.scoreElement.textContent = `Puntuaci√≥n: ${this.score} | Vidas: ${this.lives} | Nivel: ${this.level}`;
            }
        }

        // INITIALIZE GAMES
        document.addEventListener('DOMContentLoaded', () => {
            const game1 = new SnakeGame();
            const game2 = new BreakoutGame();
            const game3 = new SpaceShooterGame();
            
            // Add visual feedback for better UX
            document.querySelectorAll('.btn').forEach(btn => {
                btn.addEventListener('mouseenter', () => {
                    if (!btn.disabled) {
                        playTone(800, 0.05, 0.02);
                    }
                });
            });
        });

        // Touch support for mobile
        function addTouchSupport() {
            let touchStartX, touchStartY;
            
            document.addEventListener('touchstart', (e) => {
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
                e.preventDefault();
            });
            
            document.addEventListener('touchend', (e) => {
                if (!touchStartX || !touchStartY) return;
                
                const touchEndX = e.changedTouches[0].clientX;
                const touchEndY = e.changedTouches[0].clientY;
                
                const diffX = touchStartX - touchEndX;
                const diffY = touchStartY - touchEndY;
                
                if (Math.abs(diffX) > Math.abs(diffY)) {
                    // Horizontal swipe
                    if (diffX > 0) {
                        // Swipe left
                        document.dispatchEvent(new KeyboardEvent('keydown', {code: 'ArrowLeft'}));
                    } else {
                        // Swipe right
                        document.dispatchEvent(new KeyboardEvent('keydown', {code: 'ArrowRight'}));
                    }
                } else {
                    // Vertical swipe
                    if (diffY > 0) {
                        // Swipe up
                        document.dispatchEvent(new KeyboardEvent('keydown', {code: 'ArrowUp'}));
                    } else {
                        // Swipe down
                        document.dispatchEvent(new KeyboardEvent('keydown', {code: 'ArrowDown'}));
                    }
                }
                
                touchStartX = null;
                touchStartY = null;
                e.preventDefault();
            });
        }
        
        addTouchSupport();
    </script>
</body>
</html>